# Auto-generated DAG for Workflow: {{ workflow_name }}
# Workflow ID: {{ workflow_id }}
# Generated by MLOps Workflow System

from airflow import DAG
from airflow.operators.python import PythonOperator
from datetime import datetime, timedelta

# DAG default arguments
default_args = {
    'owner': 'mlops',
    'depends_on_past': False,
    'start_date': datetime(2024, 1, 1),
    'email_on_failure': False,
    'email_on_retry': False,
    'retries': 0,
}

# Create DAG
with DAG(
    dag_id='workflow_{{ workflow_id }}',
    default_args=default_args,
    description='{{ workflow_description }}',
    schedule_interval='{{ schedule }}',
    start_date=datetime(2024, 1, 1),
    catchup=False,
    tags=['mlops', 'auto-generated', '{{ workflow_name }}']
) as dag:

{% for task in tasks %}
    # Task: {{ task.task_id }}
    def {{ task.task_id }}_func(**context):
        """
        Auto-generated task function for: {{ task.task_id }}
        """
        # User-defined Python code
{{ task.python_callable | indent(8, first=True) }}

    {{ task.task_id }} = PythonOperator(
        task_id='{{ task.task_id }}',
        python_callable={{ task.task_id }}_func,
        op_kwargs={{ task.params }},
        retries={{ task.retry_count }},
        retry_delay=timedelta(seconds={{ task.retry_delay }}),
        provide_context=True,
    )
{% endfor %}

    # Task Dependencies
{% for task in tasks %}
{% if task.dependencies %}
{% for dep in task.dependencies %}
    {{ dep }} >> {{ task.task_id }}
{% endfor %}
{% endif %}
{% endfor %}
